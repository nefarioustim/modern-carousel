(function(f){f.fn.cleanWhitespace=function(){this.html(this.html().replace(/<\/li>\s+/gi,"</li>"))};f.fn.carousel=function(g){var b={visiblePanes:1,panesToMove:1,pagination:true,speed:200,loop:false,autoplay:false,hovercontrols:false,hoverpause:false,delay:2E3,transition:false};g&&f.extend(b,g);this.each(function(){var m,r,a=f(this),h=a.find(".clip:first"),j=h.find(">ul:first"),s=j.find(">li");b.aspectVert=/(vertical)/i.test(j.get(0).className);a.data("playing",false);h.css("overflow","hidden");j.css({position:"relative"});
j.cleanWhitespace();var n=h.width();h=h.get(0).offsetHeight;var d=0,k=s.length,p=b.aspectVert?Math.floor(h/b.visiblePanes):Math.floor(n/b.visiblePanes),i={prev:{},play:{},pause:{},next:{}},o=f('<div class="controls" />');basic=f('<ul class="basic" />');f.each(i,function(c){i[c]=f('<li class="'+c+'"><button>'+c+"</button></li>").find("button").data("name",c).end();basic.append(i[c])});basic.appendTo(o.appendTo(a));basic.delegate("button","click",function(c){c.preventDefault();a.trigger(f(this).data("name"))});
if(b.pagination){n=f('<ol class="pages" />');for(h=0;h<s.length/b.panesToMove;h++)f('<li><button value="'+h+'">'+parseInt(h+1,10)+"</button></li>").appendTo(n);n.appendTo(a.find(".controls"));n.delegate("button","click",function(c){c.preventDefault();a.trigger("jump",[c.target.value*b.panesToMove,d])})}b.hovercontrols&&o.hide();a.hover(function(){b.hovercontrols&&o.stop(true,true).fadeIn({duration:200,queue:false});if(b.hoverpause)if(r=a.data("playing")){a.trigger("pause");a.data("playing",true)}},
function(){b.hovercontrols&&o.stop(true,true).fadeOut({duration:200,queue:false});r&&b.hoverpause&&a.data("playing")&&a.trigger("play")});var l=function(c,e){if(e){c.removeClass("disabled");c.find("button").get(0).disabled=false}else{c.addClass("disabled");c.find("button").get(0).disabled=true}};a.delegate(".clip > ul > li *","focus",function(c){c=f(c.target).closest(".clip > ul > li").index();if(c>b.visiblePanes+d-1){a.trigger("pause");a.trigger("jump",c)}else if(c<d){a.trigger("pause");a.trigger("jump",
c-b.visiblePanes)}});a.bind("nav-state.carousel",function(){if(!b.loop){l(i.prev,d!=0);l(i.next,d!=k-b.panesToMove)}if(b.pagination){a.find(".pages .current").removeClass("current");a.find(".pages button").eq(Math.ceil(d/b.panesToMove)).closest("li").addClass("current")}});a.bind("move.carousel",function(c,e){j.cleanWhitespace();k=j.find("> li").length;var q=d;e=e||1;d+=e*b.panesToMove;if(d+(b.visiblePanes-b.panesToMove)>=k){if(b.loop)d=0}else if(d<=-b.panesToMove)if(b.loop)d=k+e*b.panesToMove;a.trigger("jump",
[d,q]);a.data("playing")&&!b.loop&&d==k&&a.trigger("pause")});a.bind("jump.carousel",function(c,e,q){if(e<0)e=0;if(e>k-b.visiblePanes)e=k-b.visiblePanes;d=e;c={duration:b.speed,queue:false,complete:function(){a.trigger("nav-state")}};if(b.transition)a.carousel[b.transition]({carousel:a,defaults:b,delta:p,last:q,current:d,anim:c});else b.aspectVert?j.animate({top:-p*e+"px"},c):j.animate({left:-p*e+"px"},c)});a.bind("prev.carousel",function(){a.trigger("pause");a.trigger("move",-1)});a.bind("next.carousel",
function(){a.trigger("pause");a.trigger("move",1)});a.bind("play.carousel",function(){a.data("playing",true);l(i.play,false);l(i.pause,true);m=window.setInterval(function(){a.trigger("move",1)},b.delay)});a.bind("pause.carousel",function(){a.data("playing",false);l(i.pause,false);l(i.play,true);clearInterval(m)});a.trigger("nav-state");b.autoplay?a.trigger("play"):a.trigger("pause")});return this};f.fn.carousel.fade=function(g){var b=g.carousel.find(".clip>ul>li").eq(g.last),m=g.carousel.find(".clip>ul>li").eq(g.current);
g.carousel.find(".clip>ul");b.css({position:"absolute",top:"0",left:"0","z-index":"1"});m.hide().css({position:"absolute",top:"0",left:"0","z-index":"2"});g.anim.complete=function(){b.hide();g.carousel.trigger("nav-state")};m.fadeIn(g.anim)}})(jQuery);