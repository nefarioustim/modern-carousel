(function(e){e.fn.cleanWhitespace=function(){this.contents().filter(function(){if(this.nodeType!=3){e(this).cleanWhitespace();return false}else return!/\S/.test(this.nodeValue)}).remove()};e.fn.carousel=function(g){var b={visiblePanes:1,panesToMove:1,pagination:true,speed:200,loop:false,autoplay:false,hovercontrols:false,hoverpause:false,delay:2E3,transition:false};g&&e.extend(b,g);this.each(function(){var n,a=e(this),j=a.find(".clip:first"),k=j.find(">ul:first"),s=k.find(">li");b.aspectVert=/(vertical)/i.test(k.get(0).className);
a.data("playing",false);j.css("overflow","hidden");k.css({position:"relative"});j.cleanWhitespace();var o=j.width(),l=j.get(0).offsetHeight,d=0,i=s.length,q=b.aspectVert?Math.floor(l/b.visiblePanes):Math.floor(o/b.visiblePanes),h={prev:{},play:{},pause:{},next:{}},p=e('<div class="controls" />');basic=e('<ul class="basic" />');e.each(h,function(c){h[c]=e('<li class="'+c+'"><button>'+c+"</button></li>").find("button").data("name",c).end();basic.append(h[c])});basic.appendTo(p.appendTo(a));basic.delegate("button",
"click",function(c){c.preventDefault();a.trigger(e(this).data("name"))});if(b.pagination){o=e('<ol class="pages" />');for(l=0;l<s.length/b.panesToMove;l++)e('<li><button value="'+l+'">'+parseInt(l+1,10)+"</button></li>").appendTo(o);o.appendTo(a.find(".controls"));o.delegate("button","click",function(c){c.preventDefault();a.trigger("jump",[c.target.value*b.panesToMove,d])})}b.hovercontrols&&p.hide();a.hover(function(){b.hovercontrols&&p.stop().fadeIn({duration:200,queue:false});if(b.hoverpause){if(a.data("playing"))var c=
true;a.trigger("pause");c&&a.data("playing",true)}},function(){b.hovercontrols&&p.fadeOut({duration:200,queue:false});b.hoverpause&&a.data("playing")&&a.trigger("play")});var m=function(c,f){if(f){c.removeClass("disabled");c.find("button").get(0).disabled=false}else{c.addClass("disabled");c.find("button").get(0).disabled=true}};a.delegate(".clip > ul > li *","focus",function(c){c=e(c.target).closest(".clip > ul > li").index();if(c>b.visiblePanes+d-1){a.trigger("pause");a.trigger("jump",c)}else if(c<
d){a.trigger("pause");a.trigger("jump",c-b.visiblePanes)}});a.bind("nav-state.carousel",function(){if(!b.loop){m(h.prev,d!=0);m(h.next,d!=i)}if(b.pagination){a.find(".pages .current").removeClass("current");a.find(".pages button").eq(Math.ceil(d/b.panesToMove)).closest("li").addClass("current")}});a.bind("move.carousel",function(c,f){j.cleanWhitespace();i=k.find("> li").length;var r=d;f=f||1;d+=f*b.panesToMove;if(d+(b.visiblePanes-b.panesToMove)>=i){if(b.loop)d=0}else if(d<=-b.panesToMove)if(b.loop)d=
i+f*b.panesToMove;a.trigger("jump",[d,r]);a.data("playing")&&!b.loop&&d==i&&a.trigger("pause")});a.bind("jump.carousel",function(c,f,r){if(f<0)f=0;if(f>i-b.visiblePanes)f=i-b.visiblePanes;d=f;c={duration:b.speed,queue:false,complete:function(){a.trigger("nav-state")}};if(b.transition)a.carousel[b.transition]({carousel:a,defaults:b,delta:q,last:r,current:d,anim:c});else b.aspectVert?k.animate({top:-q*f+"px"},c):k.animate({left:-q*f+"px"},c)});a.bind("prev.carousel",function(){a.trigger("pause");a.trigger("move",
-1)});a.bind("next.carousel",function(){a.trigger("pause");a.trigger("move",1)});a.bind("play.carousel",function(){a.data("playing",true);m(h.play,false);m(h.pause,true);n=window.setInterval(function(){a.trigger("move",1)},b.delay)});a.bind("pause.carousel",function(){a.data("playing",false);m(h.pause,false);m(h.play,true);clearInterval(n)});a.trigger("nav-state");b.autoplay?a.trigger("play"):a.trigger("pause")});return this};e.fn.carousel.fade=function(g){var b=g.carousel.find(".clip>ul>li").eq(g.last),
n=g.carousel.find(".clip>ul>li").eq(g.current);g.carousel.find(".clip>ul");b.css({position:"absolute",top:"0",left:"0","z-index":"1"});n.hide().css({position:"absolute",top:"0",left:"0","z-index":"2"});g.anim.complete=function(){b.hide();g.carousel.trigger("nav-state")};n.fadeIn(g.anim)}})(jQuery);